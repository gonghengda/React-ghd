```js
import React from 'react'
import { Modal, InputItem } from 'antd-mobile'

export default class Mobile extends React.Component {
	constructor(props) {
		super(props)
		this.state = {
			mobile1: "",
		}
	}

	componentWillMount() {
		if (this.props.value) {
			this.phoneBlur(this.props.value)
			this.updateValue(this.props.value)
		}
	}

	componentWillReceiveProps(nextProps) {
		if (nextProps.value != this.state.mobile1) {
			this.updateValue(nextProps.value)
		}
	}

	updateValue(v) {
		const value = v.replace(/ /g, "")
		const mobile1 = value.substr(0, 3) + " " + value.substr(3, 4) + " " + value.substr(7, 4)
		this.setState({ mobile1 })
	}

	//手机号码验证
	phoneBlur(v) {
		//投标人页面的传值 
		v = v.replace(/ /g, "")
		let v1 = v.slice(0, 1)
		let v2 = v.slice(1, 2)
		if (v != "") {
			if (!(new RegExp(this.state.phoneregular).test(v2) && v.length == 11 && v1 == 1)) {
				this.setState({ phoneSH1: true })
			} else {
				this.setState({ phoneSH1: false })
				this.demand()
			}
		} else {
			this.setState({ phoneSH1: false, homeLocation: '' })
			this.props.mobild("")
		}
	}

	inputonChange(mobile1) {
		const phoneRef = this.inputRef
		let before = phoneRef.selectionStart, after = phoneRef.selectionEnd;
		let err = false;
		if (!before && !after) err = true
		let mobile = this.inputRef.value.substr(0, 13)
		console.log("mobile---->" + mobile)
		console.log("before:", before, "------>", "after:", after)
		console.log(before, mobile.length, this.state.mobile1.length)

		let newValue = this.inputRef.value.replace(/\D/g, '').substring(0, 11);
		let valueLen = mobile1.length
		if (valueLen > 3 && valueLen < 8 && !err) {
			if (this.state.mobile1.length < mobile.length) {
				before += 1
				after += 1
			}
			newValue = `${newValue.substr(0, 3)} ${newValue.substr(3)}`;
		} else if (valueLen >= 7 && !err) {
			if ((this.state.mobile1.length < mobile.length) && (before === mobile.length)) {
				before += 2
				after += 2
			}
			newValue = `${newValue.substr(0, 3)} ${newValue.substr(3, 4)} ${newValue.substr(7)}`;
		}

		// 长度满足了光标去最后
		let islast = false;
		if ((mobile.length === 13) && (this.state.mobile1.length === 13)) islast = true

		this.setState({ mobile1: newValue }, () => {
			const subValue = mobile1.substr(before - 1, before);
			if (subValue && subValue.substr(0, 1) === ' ') {
				before = before + 1;
			}

			if (islast) {
				phoneRef.setSelectionRange(13, 13);
			} else {
				phoneRef.setSelectionRange(before, after);
			}
		})
	}

	render() {
		return (
			<div className="Mobileat">
				<div className="col-xs-12 placement" style={{ padding: "0px", border: "0px #FFFFFF" }} >
					<div className="am-list-item am-input-item am-list-item-middle">
						<div className="am-list-line">
							<div className="am-input-label am-input-label-5">
								<div>
									<span></span>
									{this.props.pay ? "银行预留手机" : <div>{this.state.everys == true ? <span style={{ color: "red" }}>*</span> : <span>  </span>}大陆手机</div>}
								</div>
							</div>
							<div className="am-input-control">
								<input
									ref={el => this.inputRef = el}
									pattern="\d*"
									type="tel"
									value={this.state.mobile1}
									onChange={(v) => this.inputonChange(this.inputRef.value)}
									onBlur={(v) => this.phoneBlur(this.inputRef.value)}
									style={{ textAlign: "right" }}
									placeholder={this.props.pay ? "请录入银行预留手机号" : "请录入手机号"}
								/>
							</div>
						</div>
					</div>
				</div>
			</div >
		)
	}
}
```
